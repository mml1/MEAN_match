<html ng-app= "gApp">
<head>
	<title>Flip Cards</title>
	<script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
	<script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular-route.min.js"></script>
	 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
		<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<link rel ="stylesheet" href = "static/stylesheets/style.css">
	<script type="text/javascript">
		var gAppModule = angular.module("gApp", ["ngRoute"]);
		gAppModule.config(function($routeProvider){
			$routeProvider
			.when("/users", {
				templateUrl: "../static/partials/users.html"
			}).otherwise({
				templateUrl: "../static/partials/board.html"
			})		
		});

		gAppModule.factory("BoardFactory", function($http){
			var factory = {};
			var cards = [
				[{card:{
						id:1,
						flip: false,
						col:0,
						row:0,
						match: false,
						face: "apple"
					}}, 
					{card:{
						id:2,
						flip: false,
						col:1,
						row:0,
						match: false,
						face: "mango"
					}},  
					{card:{
						id:3,
						flip: false,
						col:2,
						row:0,
						match: false,
						face: "grapes"
					}}],
					[{card:{
						id:4,
						flip: false,
						col:0,
						row:1,
						match: false,
						face: "pinapple"
					}}, 
					{card:{
						id:5,
						flip: false,
						col:1,
						row:1,
						match: false,
						face: "kiwi"
					}},  
					{card:{
						id:6,
						flip: false,
						col:2,
						row:1,
						match: false,
						face: "pears"
					}}],
					[{card:{
						id:7,
						flip: false,
						col:0,
						row:2,
						match: false,
						face: "kiwi"
					}}, 
					{card:{
						id:8,
						flip: false,
						col:1,
						row:2,
						match: false,
						face: "grapes"
					}},  
					{card:{
						id:9,
						flip: false,
						col:2,
						row:2,
						match: false,
						face: "mango"
					}}],
					[{card:{
						id:10,
						flip: false,
						col:0,
						row:3,
						match: false,
						face: "pears"
					}}, 
					{card:{
						id:11,
						flip: false,
						col:1,
						row:3,
						match: false,
						face: "pinapple"
					}},  
					{card:{
						id:12,
						flip: false,
						col:2,
						row:3,
						match: false,
						face: "apple"
					}}]
			]
			factory.getBoard = function(callback){
				callback(cards)
			};
			factory.updateBoard= function(flip, callback){
				cards = flip
				console.log(cards, "updated cards")

			}
			// factory.flip = function(row,id, status){
			// 	var tempr = 2
			// 	var tempid = 8
			// 	//will traverse through the cards and then will update the flip
			// 	for (var r =0; r<cards.length; r++){
			// 		//r is row
			// 		for(var c = 0; c < cards[r].length; c++){
			// 			if(r == row && c == id){
			// 			console.log(cards[r][c].card.id)
			// 			// if (cards[r] == c){
			// 			// 	console.log(cards[r][c])
			// 			// }
			// 			}
			// 		}
			// 	}
			// }
			// get the information from the scope and replace the factory board with that
			return factory;
		});
		gAppModule.factory("UserFactory", function($http){
			var factory = {};
			var users = [];
			factory.index = function(callback){
				$http.get("/REPLACE").success(function(dbinfo){
					users = dbinfo;
					callback(users);
				});
			};
			return factory;
		});

		gAppModule.controller("UsersController", function($scope, UserFactory){
			UserFactory.index(function(dbinfo){
				$scope.users = dbinfo;
			});
		});
		gAppModule.controller("MovesController", function($scope, BoardFactory){
			BoardFactory.getBoard(function(cards){
				$scope.cards = cards
			})
			$scope.flip = function(){
				console.log("in controller")
				BoardFactory.updateBoard($scope.cards, function(newCards){
					BoardFactory.getBoard(function(cards){
						$scope.cards = cards
					})
				});
			}
		});

	</script>
	
</head>
<body>
	<div class= "container">
		<a href = "#/users">Users</a>
		<div class = "row" ng-view=""></div>
	</div>

</body>
</html>
